I"Ä<h2 id="and-minimum-spanning-tree"><a href="https://vjudge.net/problem/HDU-6614">AND Minimum Spanning Tree</a></h2>

<pre><code class="language-cpp">#include &lt;bits/stdc++.h&gt;
using namespace std;
typedef long long ll;
int main()
{
	int t, n;
	for (scanf("%d", &amp;t); t--;)
	{
		scanf("%d", &amp;n);
		vector&lt;int&gt; f(n + 1, 0);
		ll ans = 0;
		for (ll i = 2; i &lt;= n; ++i)
		{
			for (ll j = 1; !f[i] &amp;&amp; j &lt;= n; j &lt;&lt;= 1)
				if (!(i &amp; j))
					f[i] = j;
			if (!f[i])
				f[i] = 1;
			ans += i &amp; f[i];
		}
		printf("%lld\n", ans);
		for (int i = 2; i &lt;= n; ++i)
			printf("%d%c", f[i], i &lt; n ? ' ' : '\n');
	}
}
</code></pre>

<h2 id="minimal-power-of-prime"><a href="https://vjudge.net/problem/HDU-6623">Minimal Power of Prime</a></h2>

<pre><code class="language-cpp">#include &lt;bits/stdc++.h&gt;
using namespace std;
typedef long long ll;
struct EulerSieve
{
	vector&lt;int&gt; p, m;
	EulerSieve(int N) : m(N, 0)
	{
		for (long long i = 2, k; i &lt; N; ++i)
		{
			if (!m[i])
				p.push_back(m[i] = i);
			for (int j = 0; j &lt; p.size() &amp;&amp; (k = i * p[j]) &lt; N; ++j)
				if ((m[k] = p[j]) == m[i])
					break;
		}
	}
} E(pow(1e18, 0.2) + 9);
ll t, n;
bool check(int q)
{
	if (q == 4)
	{
		int t = pow(n, 0.25) + 0.5;
		return 1LL * t * t * t * t == n || 1LL * (t - 1) * (t - 1) * (t - 1) * (t - 1) == n || 1LL * (t + 1) * (t + 1) * (t + 1) * (t + 1) == n;
	}
	if (q == 3)
	{
		int t = pow(n, 1.0 / 3.0) + 0.5;
		return 1LL * t * t * t == n || 1LL * (t - 1) * (t - 1) * (t - 1) == n || 1LL * (t + 1) * (t + 1) * (t + 1) == n;
	}
	if (q == 2)
	{
		int t = pow(n, 0.5) + 0.5;
		return 1LL * t * t == n || 1LL * (t - 1) * (t - 1) == n || 1LL * (t + 1) * (t + 1) == n;
	}
}
int main()
{
	for (scanf("%lld", &amp;t); t--;)
	{
		scanf("%lld", &amp;n);
		int num = 0, minn = 63;
		for (int i = 0; i &lt; E.p.size(); i++)
		{
			for (num = 0; n % E.p[i] == 0; ++num)
				n /= E.p[i];
			if (num)
				minn = min(num, minn);
			if (minn == 1)
				break;
		}
		if (n &gt; 1)
		{
			int ans = 1;
			if (minn &gt; 1 &amp;&amp; n &gt; 1)
				for (int q = 4; ans == 1 &amp;&amp; q &gt; 1; --q)
					if (check(q))
						ans = q;
			minn = min(minn, ans);
		}
		printf("%d\n", minn);
	}
}
</code></pre>
:ET